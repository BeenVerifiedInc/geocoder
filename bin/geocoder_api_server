#! /usr/bin/ruby1.9.1
require 'sinatra'
require 'geocoder/us/database'
require 'json'

set :port, 8080
@@db = Geocoder::US::Database.new(ARGV[1])
get '/geocode' do
  if params[:q]
    (@@db.geocode params[:q]).to_json
  else
    status 400
    "parameter 'q' is missing"
  end
end
